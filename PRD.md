# Lotto Automation AWS Lambda 배포 프로젝트

## 1. 프로젝트 개요

**목표**: 로또 자동 구매 스크립트를 AWS Lambda로 마이그레이션하여 주기적으로 실행

**현재 상태**:
- 로컬에서 Python 스크립트로 수동 실행
- 1Password CLI를 통해 계정 정보 조회
- 2개 계정으로 로또 구매 자동화

**목표 상태**:
- AWS Lambda에서 자동 실행 (매주 월요일 오후 3시)
- AWS Secrets Manager로 계정 정보 관리
- Terraform으로 인프라 코드화
- 실패 시 이메일 알림 (`rolroralra@gmail.com`)

---

## 2. 요구사항

### 2.1 기능 요구사항

| ID | 요구사항 | 우선순위 |
|----|---------|---------|
| FR-01 | Lambda 함수로 로또 구매 자동화 | P0 |
| FR-02 | 매주 월요일 15:00 KST 자동 실행 | P0 |
| FR-03 | AWS Secrets Manager에서 계정 정보 조회 | P0 |
| FR-04 | 실패 시 이메일 알림 발송 | P0 |
| FR-05 | 2개 이상 계정 지원 | P0 |
| FR-06 | 구매 결과 로깅 | P1 |

### 2.2 비기능 요구사항

| ID | 요구사항 | 목표값 |
|----|---------|--------|
| NFR-01 | Lambda 실행 시간 | < 5분 |
| NFR-02 | 비용 | < $5/월 |
| NFR-03 | 인프라 코드화 | Terraform 100% |
| NFR-04 | 알림 지연 | < 5분 |

---

## 3. 기술 아키텍처

```
┌─────────────────────────────────────────────────────────────────┐
│                         AWS Cloud                               │
│                                                                 │
│  ┌──────────────┐     ┌─────────────────┐     ┌──────────────┐  │
│  │  EventBridge │────>│  Lambda Function │────>│  dhlottery  │  │
│  │  (Scheduler) │     │  (lotto-auto)    │     │  .co.kr     │  │
│  │  Mon 15:00   │     └────────┬────────┘     └──────────────┘  │
│  └──────────────┘              │                                │
│                                │                                │
│                     ┌──────────┴──────────┐                     │
│                     │                     │                     │
│                     v                     v                     │
│             ┌──────────────┐      ┌──────────────┐              │
│             │   Secrets    │      │     SNS      │              │
│             │   Manager    │      │   (알림)      │              │
│             │  (계정정보)    │      └──────┬───────┘              │
│             └──────────────┘             │                      │
│                                          v                      │
│                     ┌──────────────┐  ┌──────────┐              │
│                     │     SQS      │  │  Email   │              │
│                     │    (DLQ)     │  │  알림     │              │
│                     └──────────────┘  └──────────┘              │
└─────────────────────────────────────────────────────────────────┘
```

---

## 4. 설정값

- **실행 스케줄**: `cron(0 6 ? * MON *)` (매주 월요일 15:00 KST = 06:00 UTC)
- **알림 이메일**: `rolroralra@gmail.com`
- **AWS 리전**: `ap-northeast-2` (서울)
- **Terraform State**: S3 Backend + DynamoDB Lock

---

## 5. 예상 비용 (월간)

| 서비스 | 사용량 | 예상 비용 |
|--------|--------|----------|
| Lambda | ~8회/월, 5분/회 | ~$0.05 |
| Secrets Manager | 2개 시크릿 | ~$0.80 |
| EventBridge | 8회 스케줄 | 무료 |
| SNS | 이메일 알림 | 무료 |
| SQS (DLQ) | 최소 | 무료 |
| CloudWatch Logs | ~1GB | ~$0.50 |
| **합계** | | **~$1.35** |
